<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="scripts/read-excel-file.min.js"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png">
    <link rel="manifest" href="favicon_io/site.webmanifest">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <title>Дашборд</title>
</head>

<header data-bs-theme="dark">
    <nav class="navbar" style="background-color:#1d3653;">
        <div class="container input-group">
            <input class="form-control form-control" type="file" id="input" onchange="get_data()">
        </div>
    </nav>
</header>

<body>
    <div class="container" style="margin-top: 15px;">
        <div id="tbl-stats" class="tbl-stats" style="width: 75%; margin-inline: 12.5%;">
            <div class="card-group">
                <div class="card" style="min-width: 15rem; max-width: 15rem; width: 15rem;">
                    <svg class="bd-placeholder-img card-img-top" width="100%" height="140"
                        xmlns="http://www.w3.org/2000/svg" role="img" aria-label="BSS"
                        preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="rgb(0, 100, 158)"></rect>
                        <text font-size="200%" font-weight="bold" x="50%" y="50%" fill="#FFF" dx="-.9em" dy="-.3em">
                            BSS
                        </text>
                        <text id="bss_stats" font-size="200%" x="50%" y="50%" fill="#FFF" dx="-0.3em" dy=".8em">0</text>
                    </svg>
                    <div class="card-header text-bg-success mb-3">
                        <h5 class="card-title">Услуга востановлена: ДА</h5>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="25"
                                aria-valuemin="0" aria-valuemax="100"
                                style="height: 25px; font-size: 15px; font-weight: bold;">
                                <div id="bss_y_stats" class="progress-bar bg-success" style="width: 100%">0</div>
                            </div><br>
                            Высокий 0-1: <span id="bss_y_h_stats" class="badge bg-danger">0</span><br>
                            Средний 2-3: <span id="bss_y_m_stats" class="badge"
                                style=" background-color: #fd7e14;">0</span><br>
                            Минимальный 4-5: <span id="bss_y_l_stats" class="badge bg-success">0</span>
                        </li>
                    </ul>
                    <div class="card-header text-bg-danger mb-3" style=" background-color: #fd7e14 !important;">
                        <h5 class="card-title">Услуга востановлена: НЕТ</h5>
                    </div>
                    <ul class="list-group list-group-flush">

                        <li class="list-group-item">
                            <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="25"
                                aria-valuemin="0" aria-valuemax="100"
                                style="height: 25px; font-size: 15px; font-weight: bold;">
                                <div id="bss_n_stats" class="progress-bar"
                                    style="width: 100%; background-color: #fd7e14;">0
                                </div>
                            </div><br>
                            Высокий 0-1: <span id="bss_n_h_stats" class="badge bg-danger">0</span><br>
                            Средний 2-3: <span id="bss_n_m_stats" class="badge"
                                style=" background-color: #fd7e14;">0</span><br>
                            Минимальный 4-5: <span id="bss_n_l_stats" class="badge bg-success">0</span>
                        </li>
                    </ul>
                </div>
                <div class="card" style="min-width: 15rem; max-width: 15rem; width: 15rem;">
                    <svg class="bd-placeholder-img card-img-top" width="100%" height="140"
                        xmlns="http://www.w3.org/2000/svg" role="img" aria-label="КРУС"
                        preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#fd7e14"></rect>
                        <text font-size="200%" font-weight="bold" x="50%" y="50%" fill="#FFF" dx="-1.2em" dy="-.3em">
                            КРУС
                        </text>
                        <text id="krus_stats" font-size="200%" x="50%" y="50%" fill="#FFF" dx="-.3em" dy=".8em">0</text>
                    </svg>
                    <div class="card-header text-bg-success mb-3">
                        <h5 class="card-title">Услуга востановлена: ДА</h5>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="25"
                                aria-valuemin="0" aria-valuemax="100"
                                style="height: 25px; font-size: 15px; font-weight: bold;">
                                <div id="krus_y_stats" class="progress-bar bg-success" style="width: 100%">0</div>
                            </div><br>
                            Высокий 0-1: <span id="krus_y_h_stats" class="badge bg-danger">0</span><br>
                            Средний 2-3: <span id="krus_y_m_stats" class="badge"
                                style=" background-color: #fd7e14;">0</span><br>
                            Минимальный 4-5: <span id="krus_y_l_stats" class="badge bg-success">0</span>
                        </li>
                    </ul>
                    <div class="card-header text-bg-danger mb-3" style=" background-color: #fd7e14 !important;">
                        <h5 class="card-title">Услуга востановлена: НЕТ</h5>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="25"
                                aria-valuemin="0" aria-valuemax="100"
                                style="height: 25px; font-size: 15px; font-weight: bold;">
                                <div id="krus_n_stats" class="progress-bar"
                                    style="width: 100%; background-color: #fd7e14;">0</div>
                            </div><br>
                            Высокий 0-1: <span id="krus_n_h_stats" class="badge bg-danger">0</span><br>
                            Средний 2-3: <span id="krus_n_m_stats" class="badge"
                                style=" background-color: #fd7e14;">0</span><br>
                            Минимальный 4-5: <span id="krus_n_l_stats" class="badge bg-success">0</span>
                        </li>
                    </ul>
                </div>
                <div class="card" style="min-width: 15rem; max-width: 15rem; width: 15rem;">
                    <svg class="bd-placeholder-img card-img-top" width="100%" height="140"
                        xmlns="http://www.w3.org/2000/svg" role="img" aria-label="КРУС"
                        preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#6f42c1"></rect>
                        <text font-size="200%" font-weight="bold" x="50%" y="50%" fill="#FFF" dx="-1.4em" dy="-.3em">
                            Всего
                        </text>
                        <text id="all_stats" font-size="200%" x="50%" y="50%" fill="#FFF" dx="-.3em" dy=".8em">0</text>
                    </svg>
                    <svg class="bd-placeholder-img" width="100%" height="137"
                        xmlns="http://www.w3.org/2000/svg" role="img" aria-label="КРУС"
                        preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#198754"></rect>
                        <text font-size="200%" font-weight="bold" x="50%" y="50%" fill="#FFF" dx="-2.2em" dy="-.3em">
                            В работу
                        </text>
                        <text id="work_stats" font-size="200%" x="50%" y="50%" fill="#FFF" dx="-.2em" dy=".8em">0</text>
                    </svg>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            КИС: <span id="kis_n" class="badge bg-danger">0</span> / <span id="kis_y"
                                class="badge bg-success">0</span><br>
                            ДИТ: <span id="dit_n" class="badge bg-danger">0</span> / <span id="dit_y"
                                class="badge bg-success">0</span><br>
                            ДЕЗ: <span id="dez_n" class="badge bg-danger">0</span> / <span id="dez_y"
                                class="badge bg-success">0</span>
                        </li>
                    </ul>
                    <ul class="list-group list-group-flush text-bg-secondary mb-3">
                        <div class="card-header">По сегментам</div>
                        <li class="list-group-item">
                            B2F: <span id="b2f_n" class="badge bg-danger">0</span> / <span id="b2f_y" class="badge bg-success">0</span><br>
                            B2R: <span id="b2r_n" class="badge bg-danger">0</span> / <span id="b2r_y" class="badge bg-success">0</span><br>
                            B2O: <span id="b2o_n" class="badge bg-danger">0</span> / <span id="b2o_y" class="badge bg-success">0</span><br>
                            B2G: <span id="b2g_n" class="badge bg-danger">0</span> / <span id="b2g_y" class="badge bg-success">0</span><br>
                            N/A: <span id="sso_n" class="badge bg-danger">0</span> / <span id="sso_y" class="badge bg-success">0</span><br>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="container" style="margin-top: 15px;">
        <div class="input-group mb-3">
            <select class="form-select" id="tbl-filter_th" style="max-width: 200px;" onchange="view_filter(this.value)">
            </select>
            <select class="form-select" id="tbl-filter_td" onchange="view_table(this.value)">
            </select>
        </div>
    </div>
    <div class="container" style="margin-top: 15px;">
        <div id="tbl-data" class="table-responsive" style="text-align: center;">
        </div>
    </div>
</body>

<div class="modal fade" id="tbl-modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="tbl_modal_data"></h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
            </div>
            <div class="modal-body">
                <table class="table">
                    <tbody>
                        <tr>
                            <td colspan="2">Открыт ТТ</td>
                            <th id="modal_tt"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Приоритет ТТ</td>
                            <th id="modal_prior"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Статус ТТ</td>
                            <th id="modal_status"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Клиент</td>
                            <th id="modal_client"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Адрес</td>
                            <th id="modal_address"></th>
                        </tr>
                        <tr>
                            <td colspan="2">BIL/ИЗ</td>
                            <th id="modal_bil"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Кейс внешний</td>
                            <th id="modal_out_ticket"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Тип заявителя</td>
                            <th id="modal_appli"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Проблема</td>
                            <th id="modal_problem"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Отв./Исп.</td>
                            <th id="modal_exec"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Описание проблемы </td>
                            <th id="modal_descrip"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Договор</td>
                            <th id="modal_contract"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Техническое заключение</td>
                            <th id="modal_tz"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Услуга Восстановлена</td>
                            <th id="modal_sr"></th>
                        </tr>
                        <tr>
                            <td colspan="2">Менеджер сопр.</td>
                            <th id="modal_manag"></th>
                        </tr>
                    </tbody>
                </table>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
            </div>
        </div>
    </div>
</div>
<script>
    var data, filter_th_id;
    function get_data() {
        readXlsxFile(input.files[0]).then(function (excel) {
            data = excel;
            view_stats(data);
            // view_table(data);
            // console.log(data);
        })
    }
</script>
<script src="scripts/main_script.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
    integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
    crossorigin="anonymous"></script>

</html>