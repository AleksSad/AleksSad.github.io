<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="scripts/read-excel-file.min.js"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png">
    <link rel="manifest" href="favicon_io/site.webmanifest">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <title>Дашборд</title>
</head>

<header data-bs-theme="dark">
    <nav class="navbar" style="background-color:#1d3653;">
        <div class="container input-group">
            <input class="form-control form-control" type="file" id="input" onchange="get_data()">
            <div class="input-group-text">
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault2" checked>
                    <label class="form-check-label" for="flexRadioDefault2">
                        Дашборд 04
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
                    <label class="form-check-label" for="flexRadioDefault1">
                        Таблица
                    </label>
                </div>
            </div>
        </div>
    </nav>
</header>

<body>
    <div class="container" style="margin-top: 15px;">
        <div id="tbl-stats" class="tbl-stats" style="width: 50%">
            <div class="card-group">
                <div class="card" style="width: 18rem">
                    <svg class="bd-placeholder-img card-img-top" width="100%" height="180"
                        xmlns="http://www.w3.org/2000/svg" role="img" aria-label="BSS"
                        preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="rgb(0, 100, 158)"></rect>
                        <text font-size="200%" font-weight="bold" x="50%" y="50%" fill="#FFF" dx="-1em" dy="-.5em">
                            BSS
                        </text>
                        <text id="bss_stats" font-size="200%" x="50%" y="50%" fill="#FFF" dx="-0.7em" dy="1em">0</text>
                    </svg>
                    <div class="card-body">
                        <h5 class="card-title">Услуга востановлена: ДА</h5>
                        <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100"
                            style="height: 25px; font-size: 15px; font-weight: bold;">
                            <div id="bss_y_stats" class="progress-bar bg-success" style="width: 100%">0</div>
                        </div>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            Высокий 0-1: <span id="bss_y_h_stats" class="badge bg-danger">0</span><br />
                            Средний 2-3: <span id="bss_y_m_stats" class="badge"
                                style=" background-color: #ff7300;">0</span><br />
                            Минимальный 4-5: <span id="bss_y_l_stats" class="badge bg-success">0</span>
                        </li>
                    </ul>
                    <div class="card-body">
                        <h5 class="card-title">Услуга востановлена: НЕТ</h5>
                        <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100"
                            style="height: 25px; font-size: 15px; font-weight: bold;">
                            <div id="bss_n_stats" class="progress-bar" style="width: 100%; background-color: #ff7300;">0
                            </div>
                        </div>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            Высокий 0-1: <span id="bss_n_h_stats" class="badge bg-danger">0</span><br />
                            Средний 2-3: <span id="bss_n_m_stats" class="badge"
                                style=" background-color: #ff7300;">0</span><br />
                            Минимальный 4-5: <span id="bss_n_l_stats" class="badge bg-success">0</span>
                        </li>
                    </ul>
                </div>
                <div class="card" style="width: 18rem">
                    <svg class="bd-placeholder-img card-img-top" width="100%" height="180"
                        xmlns="http://www.w3.org/2000/svg" role="img" aria-label="КРУС"
                        preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#b58816"></rect>
                        <text font-size="200%" font-weight="bold" x="50%" y="50%" fill="#FFF" dx="-1em" dy="-.5em">
                            КРУС
                        </text>
                        <text id="krus_stats" font-size="200%" x="50%" y="50%" fill="#FFF" dx="-.5em" dy="1em">0</text>
                    </svg>
                    <div class="card-body">
                        <h5 class="card-title">Услуга востановлена: ДА</h5>
                        <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100"
                            style="height: 25px; font-size: 15px; font-weight: bold;">
                            <div id="krus_y_stats" class="progress-bar bg-success" style="width: 100%">0</div>
                        </div>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            Высокий 0-1: <span id="krus_y_h_stats" class="badge bg-danger">0</span><br />
                            Средний 2-3: <span id="krus_y_m_stats" class="badge"
                                style=" background-color: #ff7300;">0</span><br />
                            Минимальный 4-5: <span id="krus_y_l_stats" class="badge bg-success">0</span>
                        </li>
                    </ul>
                    <div class="card-body">
                        <h5 class="card-title">Услуга востановлена: НЕТ</h5>
                        <div class="progress" role="progressbar" aria-label="Success example" aria-valuenow="25"
                            aria-valuemin="0" aria-valuemax="100"
                            style="height: 25px; font-size: 15px; font-weight: bold;">
                            <div id="krus_n_stats" class="progress-bar" style="width: 100%; background-color: #ff7300;">
                                0</div>
                        </div>
                    </div>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                            Высокий 0-1: <span id="krus_n_h_stats" class="badge bg-danger">0</span><br />
                            Средний 2-3: <span id="krus_n_m_stats" class="badge"
                                style=" background-color: #ff7300;">0</span><br />
                            Минимальный 4-5: <span id="krus_n_l_stats" class="badge bg-success">0</text></span>
                        </li>
                    </ul>
                </div>
                <div class="card" style="width: 18rem">
                    <svg class="bd-placeholder-img card-img-top" width="100%" height="180"
                        xmlns="http://www.w3.org/2000/svg" role="img" aria-label="КРУС"
                        preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#8e3ac2"></rect>
                        <text font-size="200%" font-weight="bold" x="50%" y="50%" fill="#FFF" dx="-1em" dy="-.5em">
                            Всего
                        </text>
                        <text id="all_stats" font-size="200%" x="50%" y="50%" fill="#FFF" dx="-.5em" dy="1em">0</text>
                    </svg>
                    <svg class="bd-placeholder-img card-img-top" width="100%" height="180"
                        xmlns="http://www.w3.org/2000/svg" role="img" aria-label="КРУС"
                        preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#2E7D32"></rect>
                        <text font-size="200%" font-weight="bold" x="50%" y="50%" fill="#FFF" dx="-1.5em" dy="-.5em">
                            В работу
                        </text>
                        <text id="work_stats" font-size="200%" x="50%" y="50%" fill="#FFF" dx="-.5em" dy="1em">0</text>
                    </svg>
                </div>
            </div>
        </div>
    </div>
    <div class="container" style="margin-top: 15px;">
        <div class="input-group mb-3">
            <select class="form-select" id="tbl-filter_th" style="max-width: 200px;" onchange="view_filter(this.value)">
            </select>
            <select class="form-select" id="tbl-filter_td" onchange="view_table(this.value)">
            </select>
        </div>
    </div>
    <div class="container" style="margin-top: 15px;">
        <div id="tbl-data" style="text-align: center;">
        </div>
    </div>
</body>
<script>
    var data, filter_th_id;
    function get_data() {
        readXlsxFile(input.files[0]).then(function (excel) {
            data = excel;
            view_stats(data);
            // view_table(data);
            // console.log(data);
        })
    }
</script>
<script src="scripts/main_script.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
    integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
    crossorigin="anonymous"></script>

</html>